<!DOCTYPE html>
<html lang="en">

<head>

    <meta name="description" content="Weipeng Log Book" />
    <meta name="robots" content="noindex nofollow" />
    <meta http-equiv="author" content="Weipeng" />
    <meta http-equiv="pragma" content="no-cache" />
    <link rel="stylesheet" type="text/css" href="../general_css/general.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
        integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"
        integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd"
        crossorigin="anonymous"></script>
    <!--[if lt IE 9]>
   		<script src=http://html5shiv.googlecode.com/svn/trunk/html5.js></script>
	<![endif] -->


    <style>
        body {
            position: relative;
            background-image: url("../images/weipeng.jpg");
        }

        ul.nav-list {
            top: 70px;
            position: fixed;
            font-size: medium;
            font-weight: bold;
            line-height: 30px;
            list-style-type: none;
        }

        ul.nav-list li a {
            padding: 5px 5px 5px 5px;
            color: rgb(255, 255, 255);
            border-radius: 4px;
        }

        ul.nav-list li a:hover {
            padding: 5px 5px 5px 5px;
            background-color: rgb(39, 79, 189);
            text-decoration: none;
            color: white;
            border-radius: 4px;
        }

        .week_log {
            position: relative;
            top: 70px;
            padding: 3px 10px 3px 10px;
            border-radius: 7px;
        }

        div.week_log img {
            width: 85%;
        }
    </style>
</head>

<body>
    <div id="page" class="container">

        <nav class="col-sm-3">
            <ul class="nav-list">
                <li><a href="#week1">Week 1</a></li>
                <li><a href="#week2">Week 2</a></li>
                <li><a href="#week3">Week 3</a></li>
                <li><a href="#week4">Week 4</a></li>
                <li><a href="#week5">Week 5</a></li>
                <li><a href="#week6">Week 6</a></li>
                <li><a href="#week7">Week 7</a></li>
                <li><a href="#week8">Week 8</a></li>
                <li><a href="#week9">Week 9</a></li>
                <li><a href="#week10">Week 10</a></li>
                <li><a href="#week11">Week 11</a></li>
                <li><a href="#week12">Week 12</a></li>
            </ul>
        </nav>

        <div class="col-sm-9">
            <h1>Weipeng's Log Book</h1>
            <div id="week1">
                <div class="week_log" style="background-color: aqua;">
                    <h1>Week 1</h1>
                    <ul style="line-height: 30px;">
                        <li>May 21, 2020
                            <ul>
                                <li>Finished project webpage framework</li>
                                <li>Finished github set up</li>
                            </ul>
                        </li>
                        <br />
                        <li>May 22, 2020
                            <ul>
                                <li>Set up Nucleo board for programming</li>
                                <li>Can't set up Atollic, switch to CubeIDE</li>
                                <li>Encounter "GDB server" error. Solved by switch power source to ST-link</li>
                            </ul>
                        </li>
                        <br />
                        <li>May 23, 2020
                            <ul>
                                <li>continue on Nucleo board programming</li>
                                <li>code can be complied and uploaded successfully, when push blue button, difficult to
                                    tell if it's triggered because of reciving message</li>
                                <li>need to figure out a way to verify message is actually received</li>
                                <li>try to work with external button and LEDs
                                    <ul>
                                        <li>Buttons are set to active low by default</li>
                                        <li>Blue Button is PC13</li>
                                        <li>Pinout Map
                                            <table>
                                                <tr>
                                                    <td>Floor</td>
                                                    <td>Button</td>
                                                    <td>LED</td>
                                                </tr>
                                                <tr>
                                                    <td> 1 </td>
                                                    <td> PC13 </td>
                                                    <td> PA5 </td>
                                                </tr>
                                                <tr>
                                                    <td> 2 </td>
                                                    <td> PC12 </td>
                                                    <td> PA6 </td>
                                                </tr>
                                                <tr>
                                                    <td> 3 </td>
                                                    <td> PC11 </td>
                                                    <td> PA7 </td>
                                                </tr>
                                            </table>
                                        </li>
                                        <li>set EXIT15_10_IRQHandler() to check which line flag is set, then pass the
                                            pin to HAL_GPIO_EXTI_IQRHandler()
                                        </li>
                                        <li>According to the passed-in pin, HAL_GPIO_EXTI_Callback() will set different
                                            button flag
                                        </li>
                                        <li>In main function, will send out different floor message according to button
                                            flags
                                        </li>
                                    </ul>
                                </li>
                                <li>Set up filter
                                    <ul>
                                        <li>Assume need to accept ID 0x100 to 0x103</li>
                                        <li>Set filter.FilterIdHight to 0x0100&lt&lt5 (shift 5 digit to 5 because
                                            standard ID only has 11 digits)</li>
                                        <li>Set filter.FilterMaskIdHigh to 0xFF80 (for the 11-digit ID, the left 9
                                            digits have to exact match)</li>
                                        <li>set sender ID to 0x100 ~ 0x103, the LEDs works properly</li>
                                        <li>set sender ID to 0x104, the LED does not respond. Filter works properly</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <br />

                    </ul>
                </div>
            </div>
            <br />
            <div id="week2">
                <div class="week_log" style="background-color: plum;">
                    <h1>Week 2</h1>
                    <ul style="line-height: 30px;">
                        <li>May 25, 2020
                            <ul>
                                <li>Nucleo64 CAN demo wiring diagram</li>
                                <img src="../images/weipeng_logbook/CAN demo wiring diagram.png" alt="Wiring diagram"
                                    title="Wiring diagram" width="500" />
                            </ul>
                        </li>
                        <li>May 28, 2020
                            <ul>
                                <li>Update Project Webpage</li>
                                <ol>
                                    <li>Added meta tags</li>
                                    <li>Added login and request access pages</li>
                                    <li>Added google map iframe</li>
                                </ol>
                            </ul>
                        </li>
                        <li>May 29, 2020
                            <ul>
                                <li>Transfer Nishant's finite state machine logic from word to html</li>
                                <li>Add basic states diagram and target setting algorithm</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week3">
                <div class="week_log" style="background-color: yellow">
                    <h1>Week 3</h1>
                    <ul style="line-height: 30px;">
                        <li>June 1, 2020
                            <ul>
                                <li>Create weekly status report for week 2</li>
                                <li>Improve status report page</li>
                                <li>Remake resume. The current resume style is not attractive and lack key skill
                                    information. Will need to find a good format and fill in skills</li>
                            </ul>
                        </li>
                        <li>June 2, 2020
                            <ul>
                                <li>Remake cover letter. The current cover letter lacks the introduction of the school
                                    program. Will add a paragraph for it</li>
                                <li>Prepare for data com quiz 1</li>
                            </ul>
                        </li>
                        <li>June 3, 2020
                            <ul>
                                <li>Prepare for math quiz 2</li>
                                <li>Finished math assignment 6. Not sure if using F or f to do the calculate</li>
                            </ul>
                        </li>
                        <li>June 4, 2020
                            <ul>
                                <li>Watched Natural Science week 3 lecture 2 part A (part B is not available yet, need
                                    to find a time to finish it)</li>
                                <li>After discuss the math assignment with Eduard, found my way to do assignment 6 is
                                    wrong. For assignment 6b, seems we still lack some knowledge</li>
                                <li>Worked on project login and request_access pages. Now the input boxes are aligned
                                </li>
                                <img src="../images/weipeng_logbook/input_box_alignment.png" alt="input_boxes"
                                    title="input_box_alignment" width="300" />
                                <li>Add copyright footers to each page</li>
                                <li>Finished software assignment#1 Q14-a. Will continue to work on Q14-b</li>
                            </ul>
                        </li>
                        <li>June 5, 2020
                            <ul>
                                <li>finished software assignment#1 Q14-b. Will need someone to review the page</li>
                            </ul>
                        </li>
                        <li>June 7, 2020
                            <ul>
                                <li>change Eduard's navigation bar a little and generalized it to all our pages</li>
                                <li>Try to build a nested dropdown menu, find a source here: <a
                                        href="https://stackoverflow.com/questions/44467377/bootstrap-4-multilevel-dropdown-inside-navigation">https://stackoverflow.com/questions/44467377/bootstrap-4-multilevel-dropdown-inside-navigation</a>
                                </li>
                                <img src="../images/weipeng_logbook/nested-dropdown-example.png" alt="dropdown example"
                                    title="dropdown example" width="300">
                                <li>The nested dropdown doesn't work. The secondary dropdown menu position shifted</li>
                                <li>May require JavaScript function to do it?</li>
                            </ul>
                        </li>
                        <li>June 8, 2020
                            <ul>
                                <li>remake the project home page with slide show with carousel</li>
                                <img src="../images/weipeng_logbook/home_slide_show_example.png"
                                    alt="slide show example" title="slide show example" width="500">
                                <li>restructure the header with grip. Want the team logo to disappear when window is
                                    narrow.
                                </li>
                                <li>hasn't found a way to hide the logo. Online sources are more for bootstrap 4: <a
                                        href="https://mdbootstrap.com/snippets/jquery/ascensus/131016">https://mdbootstrap.com/snippets/jquery/ascensus/131016</a>
                                </li>
                                <li>Try to change the bootstrap to version 4, need adjustments for the slide show. I can
                                    have the slide show works, but the prev and next buttons are invisible. Also the
                                    .d-md-none doesn't work well</li>
                                <li>Rollback to bootstrap 3 since the slide show buttons' issue</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week4">
                <div class="week_log" style="background-color: greenyellow">
                    <h1>Week 4</h1>
                    <ul style="line-height: 30px;">
                        <li>June 11, 2020
                            <ul>
                                <li>Try to set up LAMP at personal Rpi4</li>
                                <li>"sudo apt-get install lamp-server^" didn't work. couldn't find the package. Have to
                                    install apache2, php, mySQL, phpMyAdmin individually</li>
                                <li>The mysql-client part of the instruction is outdated. Used mariadb-server instead
                                </li>
                                <li>Used <a
                                        href="https://howtoraspberrypi.com/how-to-install-web-server-raspberry-pi-lamp/">this</a>
                                    resource to finish the rest</li>
                                <li>Successfully access the mySQL database and create a new user</li>
                            </ul>
                        </li>
                        <li>June 12, 2020
                            <ul>
                                <li>Switch my main workstation to Mac. Set up git, vscode, XAMPP, etc for the project
                                </li>
                                <li>Becuase I feel my knowledge regarding HTML, CSS, and JavaScript are not concrete, I
                                    decide to take this chance to review web knowledge that is required by the project
                                </li>
                                <li>Some project webpage components, such as the navigation bar and bootstrap
                                    functionalities are done by others. Need to practise how to make them</li>
                                <li>Built a personal practice website from ground up</li>
                                <li>Build the same style of nav bar with the help from <a
                                        href="https://www.w3schools.com/bootstrap/bootstrap_navbar.asp">here</a></li>
                            </ul>
                        </li>
                        <li>June 13, 2020
                            <ul>
                                <li>Continue to practise my web skills on the personal website</li>
                                <li>Build a second vertical nav bar, called scrollsp, that can interact with the main
                                    content. Get resource from <a
                                        href="https://www.w3schools.com/bootstrap/bootstrap_scrollspy.asp">here</a></li>
                                <img src="../images/weipeng_logbook/scrollspy.png" width="600"
                                    alt="scrollspy screenshot">
                                <li>Built log-in and sign-up pages with bootstrap. Get resource from <a
                                        href="https://www.w3schools.com/bootstrap/bootstrap_forms.asp">here</a></li>
                                <img src="../images/weipeng_logbook/login-bootstrap.png" width="600"
                                    alt="login page built with bootstrap">
                                <li>Practise putting an image along with inputs</li>
                                <img src="../images/weipeng_logbook/side image.png" width="600"
                                    alt="image aside other element">
                                <li>Try to have image rollover effect on project log in page
                                    <ul>
                                        <li>Try to use the pseudo element method (:hover, :active) to make image
                                            rollover, but it doesn't work. Guess if the target element is covered by
                                            other elements, the mouse event is not triggered</li>
                                        <li>Use JavaScript to realize the effect. Create a set of 3 images: one for
                                            inactive status, one for mouse hover status, and another one for mouse click
                                            status
                                        </li>
                                        <img src="../images/weipeng_logbook/image rollover1.png" width="400"
                                            alt="button designs">
                                        <li>Create 3 event listener for the button. Then change source image according
                                            to coresponding events. The idea was inspired by <a
                                                href="https://stackoverflow.com/questions/18032220/css-change-image-src-on-imghover">this</a>.
                                        </li>
                                        <img src="../images/weipeng_logbook/image rollover2.png" width="400"
                                            alt="buttons at inactive status">
                                    </ul>
                                </li>
                                <li>encounter issue after Eduard putting navbar and bootstrap codes in one place</li>
                                <li>It is quite wired that the same code works in PC, but not at my Mac and Rpi4</li>
                                <li>It seems the .php files failed to run properly</li>
                                <li>Found the reason: the apache servers in Mac and Rpi4 didn't prioritize index.php
                                    over index.html, while the server in PC does so. Just need to specify the page path
                                    to index.php, then everything works fine</li>
                            </ul>
                        </li>
                        <li>June 14, 2020
                            <ul>
                                <li>Convert my look book to the scrollspy format</li>
                                <li>The conversiont didn't go very well. The side navigation list was not highlighted
                                    automatically when main content is scrolled.</li>
                                <li>Found that if content sections are in different heights, the scrollspy format
                                    doesn't work</li>
                                <li>Try to convert the daily activity to sub menu items, but still had the same problem
                                </li>
                                <li>Cannot have the scrollspy format worked, rollback to original format</li>
                                <li>Manually create a side panel and make a ancher list to scroll to weekly contents.
                                    Since the top nav bar hides some space, have to wrap the week section into a div and
                                    offset each section by 70px</li>
                                <li>Beautify the log book with coloured sections and border radius</li>
                            </ul>
                        </li>
                        <li>June 15, 2020
                            <ul>
                                <li>After adding .php control on all .html pages, there is repeated issue that a notice
                                    of session_start() appears on top of each page.</li>
                                <li>The log in page shows error message that the username is missing from php.</li>
                                <li>The first issue is caused by using the top_header.php, which includes a
                                    session_start() and repeats if top_header.php is called at other .php files</li>
                                <li>The second issue happens because the login page starts a session when the page is
                                    opened, but the username and password haven't been input yet. Add an
                                    authenticate.php to link the login form and remove session_start() from
                                    login.php.
                                </li>
                                <li>Add authenication from JSON file. Now is ready for getting credentials from database
                                </li>
                            </ul>
                        </li>
                        <br />
                    </ul>
                </div>
            </div>
            <br />
            <div id="week5">
                <div class="week_log" style="background-color: orange;">
                    <h1>Week 5</h1>
                    <ul style="line-height: 30px;">
                        <li>June 21, 2020
                            <ul>
                                <li>try to save sign-up user data to the json file
                                    <ul>
                                        <li>Since the sign up and log in process will eventually implement with
                                            database, so this is only for practise and will only be deployed at my
                                            personal website</li>
                                        <li>Try to use the json_encode() and file_put_content(.. $flags=FILE_APPEND),
                                            but it doesn't work. The new data will be appended directly outside the
                                            original json structure.</li>
                                        <li>Try to use array_merge() function (<a
                                                href="https://www.php.net/manual/en/function.array-merge.php">Source</a>),
                                            the array is appended into the structure, but not separated as a secondary
                                            array.</li>
                                        <li>Try to use array_push() function (<a
                                                href="https://www.php.net/manual/en/function.array-push.php">Source</a>),
                                            then all the new user data will be appended to the end of the structure as a
                                            single element</li>
                                        <img src="../images/weipeng_logbook/weipeng json put content code.png"
                                            width="600" alt="json code to put content into json file">
                                    </ul>
                                </li>
                                <li>set up database at local computer
                                    <ul>
                                        <li>Try to follow Michael's first database slide to set up mySQL at my MAC</li>
                                        <li>Encounter a big issue - after drop user root@localhost and create user
                                            root@%, the mysql database disappear. I can still log in as root user
                                            without password, but SHOW DATABASES does not show mysql database. And I
                                            can't edit other databases as well. Keep getting error "Access Denied from
                                            user ''@'localhost'..."</li>
                                        <li>Try to reset root password in safe mode by following <a
                                                href="https://gist.github.com/zubaer-ahammed/c81c9a0e37adc1cb9a6cdc61c4190f52">this
                                                instruction</a>, but the safe mode server didn't run properly, so
                                            couldn't reset password.</li>
                                        <li>End up reinstalling XAMPP, and the mysql came back.</li>
                                        <li>Instead of deleting the root user, I created a new user and give it all
                                            privileges following the option 1 instruction.</li>
                                        <li>The new user was still problematic, couldn't use it to login mysql</li>
                                        <li>Instead of creating user at "%", I used "localhost", then everything works.
                                        </li>
                                    </ul>
                                </li>
                                <li>Practise creating some database from terminal
                                    <ul>
                                        <li>Managed to create elevatorNetwork and CAN_subNetwork tables</li>
                                        <img src="../images/weipeng_logbook/weipeng elevatornetwork table practise.png"
                                            width="600" alt="elevatorNetwork table">
                                        <img src="../images/weipeng_logbook/weipeng can subnetwork table practise.png"
                                            width="600" alt="CAN_subNetwork table">
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>June 22, 2020
                            <ul>
                                <li>Learn how to communicate back-end with database
                                    <ul>
                                        <li>After trying out the select statement from Michael's slide, I managed to get
                                            rows from database:</li>
                                        <img src="../images/weipeng_logbook/weipeng get rows from elevator table.png"
                                            width="600" alt="rows from database">
                                        <li>Successfully inserted new row to database from back-end:</li>
                                        <img src="../images/weipeng_logbook/weipeng insert  row to elevator table.png"
                                            width="600" alt="insert row to database">
                                    </ul>
                                </li>
                                <li>Try to implement credentials verification and user sign-up with database
                                    <ul>
                                        <li>Created a credentials table including user info such as: email, username,
                                            password, birthday, gender, is_student, is_teacher, is_staff, otherInfo</li>
                                        <img src="../images/weipeng_logbook/weipeng userCredential table.png"
                                            width="600" alt="user credential table">
                                        <li>For the credentials verification, the back-end will prepare a SQL statement
                                            according to user-input email, which is the primary key for the credential
                                            database. If the email exists at the userCredentials table, then continue to
                                            check the corresponding password</li>
                                        <img src="../images/weipeng_logbook/weipeng user verification code.png"
                                            width="600" alt="user verification with database">
                                        <li>For signing up new users, will form a new user array, then create SQL
                                            statement with the new user array</li>
                                        <img src="../images/weipeng_logbook/weipeng user sign-up code.png" width="600"
                                            alt="sign up new user to database">
                                        <li>Will need to find a way to check duplicate user</li>
                                    </ul>
                                </li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </div>
            <br />
            <div id="week6">
                <div class="week_log" style="background-color: lightgreen;">
                    <h1>Week 6</h1>
                    <ul style="line-height: 30px;">
                        <li>June 25, 2020
                            <ul>
                                <li>Continue to work on email duplicate check with AJAX</li>
                                <ul>
                                    <li>The JavaScript codes are basically given by Michael. Need to figure out the php
                                        side</li>
                                    <li>the ajax function at JS will receive the message from "echo" in php. Found a
                                        good resource at <a
                                            href="https://www.w3schools.com/php/php_ajax_php.asp">here</a></li>
                                    <li>Not sure why keep receiving responseText that contents more than just the echo
                                        message</li>
                                    <li>var_dump() will also sends data back to JS.</li>
                                    <li>Now JS can talk to php with ajax. Time to hook php with database</li>
                                    <li>When try to select a non-existed row in a table, the execution result is true,
                                        just return an empty array. So if the database execution result is an empty
                                        array, means no duplicate entry</li>
                                    <li>Successfully have the email checked! When email is duplicated, a red warning
                                        will show up, otherwise, a blue message will tell the email is ok.</li>
                                    <img src="../images/weipeng_logbook/weipeng email duplicate example.png"
                                        width="600" />
                                    <img src="../images/weipeng_logbook/weipeng email ok example.png" width="600" />
                                </ul>
                                <li>Implement all credentials functions in project webpage</li>
                            </ul>
                        </li>
                        <li>June 26, 2020
                            <ul>
                                <li>Transfer all credentials functions from test website to project website
                                    <ul>
                                        <li>The request access form includes a practise checkbox field which has
                                            nonsense options. Changed it to course enrollment options as additional
                                            info.</li>
                                        <li>Add several form validation JS functions ensure submitted data is valid:
                                            comparePassword(), checkInputLength(), checkUsernameDuplucate(),
                                            validateForm(). validateForm will call all other functions when submit
                                            button is clicked. Any validation failure will prevent the form submission.
                                        </li>
                                        <li>Created a new database named "project_database at school rpi". Created a
                                            user credential table that matches request access form</li>
                                        <img src="../images/weipeng_logbook/userCredentials Table.png">
                                        <li>Add duplicate user name check</li>
                                        <img src="../images/weipeng_logbook/duplicated user name.png">
                                        <img src="../images/weipeng_logbook/valid username.png">
                                        <li>Successfully Signed up first user account througth request access page</li>
                                        <li>Successfully log in with the newly-created user account</li>
                                    </ul>
                                </li>
                                <li>Pull the updated project to school Rpi
                                    <ul>
                                        <li>Encountered issue after pull from master. User cannot submit request access form, but the same code worked perfectly at my Mac.</li>
                                        <li>Found a bug at the duplicate check php function. Fixed and try again. Still not worked</li>
                                        <li>It seemed the AJAX function did not work properly at Rpi. The AJAX worked fine when cursor out of focus, but it didn't work when subtmit button was clicked. Might be caused by slow database response?</li>
                                        <li>Added try and catch error to AJAX function, but didn't catch any error</li>
                                        <li>Whenver disabled the AJAX function, the form could be submitted successufully. Might need to find a workaround to the issue.</li>
                                        <li>Add a duplicate check flag to the JS file. Once the first check is passed, the flag is set, then at the time of submission, validateForm() will only check the duplicate flag.</li>
                                        <li>This workaround seemed work fine. so we can consider the user credential system is up and running.</li>
                                    </ul>
                                </li>
                            </ul>
                        <li>June 27, 2020
                            <ul>
                                <li>Eduard can successfully create a user account and login from his side. The user credential system is fine now.</li>
                            </ul>
                        </li>
                        </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week7">
                <div class="week_log" style="background-color: cyan;">
                    <h1>Week 7</h1>
                    <ul style="line-height: 30px;">
                        <li>June 29, 2020
                            <ul>
                                <li>Try to make our web GUI work with the real elevator
                                    <ul>
                                        <li>Need to understand how the real elevator is controlled</li>
                                        <li>From Micheal's demo code, the C++ code keeps reading currentFloor from elevatorNetwork where nodeID=1, so as long as the number of currentFloor in db is changed, the real elevator will act correspondingly.</li>
                                        <li>The C++ program does not set status of the elevator in the database, which may be a problem if we want the GUI to sync with the real elavator. Will leave this for now.</li>
                                        <li>To talk to the database without refreshing the page, will need to use ajax function. This will be similar to the username duplication check function.</li>
                                        <li>Created a set of functions in elevator.js: setFloorDB(floor) and getFloorDB(). Whenever these functions are called, they will make http request to backend.</li>
                                        <li>Created a elevator_control.php to handle the http request from above functions. If request command is null, it means get current floor from database, otherwise it will set the current floor to the request value.</li>
                                        <li>getFloorDB() should have reture a value, but it only returns "undefined", which is similar to the issue I encountered for the username duplication check. Need further debugging.</li>
                                        <li>The backend works properly. It can get value from database properly and echo the value.</li>
                                        <li>Search the issue online, and found that actually ajax functions are async functions, which will have a time gap between make request and get response. The best way to deal with it is to use callback function, which I am not so sure how it works.</li>
                                        <li>Found some useful resources at <a href="https://stackify.com/return-ajax-response-asynchronous-javascript-call/">here</a> and <a href="https://www.w3schools.com/xml/ajax_xmlhttprequest_response.asp">here</a></li>
                                        <li>Basically, I need to pass in a function to the getFloorDB(). Whenever the response is received, the passed-in function will be called. The passed-in function will get the result from ajax function and continue to operate with that result.</li>
                                        <li>In order to ensure the GUI elevator is sync with database, getFloorDB() will be called whenever the page is loaded. Then change the GUI according to result.</li>
                                        <li>Since the default position of GUI elevator is at 3rd floor, the GUI may flash a change at the beginning. I think it's acceptable.</li>
                                        <li>Considering there is nothing constantly checking the actual floor number in db and no elevator controlling logic, will slow down the GUI elevator animation to aviod floor change before sending another command</li>
                                        <li>I can see the real elevator is moving when I push button in the GUI. The database value also changes accordingly.</li>
                                        <img src="../images/weipeng_logbook/db value changed when button was pushed.png"/>
                                        <li>Things to do: 1. the elevator GUI works separatedly from the real elevator, need some sorts of sync mechanism; 2. There is no any error handling and protection mechanism to the control system; 3. Need a way to integreate the elevator control logic. </li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>July 4, 2020
                            <ul>
                                <li>Have a meeting with Nishant and Ramtin. Eduard can't attend because of work.</li>
                                <li>Ramtin finished the stat page html and css coding, will continue to work on js. Nishant will start to work on diagnostic system, which will need him to create a new git repo for C++ program.</li>
                                <li>Eduard wrote some functions for elevator control logic. We will work on integrating the elevator control logic with our program.</li>
                                <li>Talked 2hr with Edurad at night. Realized several issues and generated an initial solution:
                                    <ul>
                                        <li>We decided to put the logic control at the backend, in order to take advantage of the array manupilation ability of php. However, this will cause an issue that the backend will not be informed when the database is updated by the C++ code, so we need something to constantly check the database.</li>
                                        <li>Currently, the C++ code only use the current floor value to operate. It does not update elevator status(moving or stop). Also, the C++ code will update the db even before the real elevator actually finishes the command.</li>
                                        <li>After discussion, we decided that Eduard will focus on the logic control integration. When a button is pressed, a button id will be passed to logic control backend. The backend will process the data, save the control array to json file, and update db values according to its processing result. Meanwhile, there should be a watchdog function constantly checking the database. Once the last command is executed successfully, the watchdog function will send the next target to db, until there is no next target in the control array.</li>
                                        <li>I will work on the C++ code and my tasks are to understand what CAN messages are transmitted and received when elevator moves and to figure out a way to update elevator status to reflect the actual situation.</li>
                                    </ul>
                                </li>

                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week8">
                <div class="week_log" style="background-color: yellow;">
                    <h1>Week 8</h1>
                    <ul style="line-height: 30px;">
                        <li>July 11, 2020
                            <ul>
                                <li>Create tables in database to be able to indicate elevator status and log elevator stats.</li>
                                <ul>
                                    <li>From Michael's hint given in last debriefing, the elevator control should keep broadcasting the current floor of the elevator.</li>
                                    <li>Using the demo code->option2, we can tell the current floor at the data(Last byte of the data, floor 1 is 5, floor 2 is 6, and floor 3 is 7)</li>
                                    <li>This floor number will not change until the elevator actually reaches the floor, so we can use it to indicate the status of the elevator.</li>
                                    <li>The following tables have been created in the database for elevator control and statstics:
                                        <ul>
                                            <li>elevatorControl - main table to indicate requested floor, current floor and status</li>
                                            <img src="../images/weipeng_logbook/elevatorControl table.png"/>
                                            <li>elevatorNetwork - a table connects nodeID to its label</li>
                                            <img src="../images/weipeng_logbook/elevatorNetwork table.png"/>
                                            <li>floorStats - record number of hits, last stay time, total stay time for each floor</li>
                                            <img src="../images/weipeng_logbook/floorStats table.png"/>
                                            <li>floorHistory - add a new log everytime a floor is reached</li>
                                            <img src="../images/weipeng_logbook/floorHistory table.png"/>
                                        </ul>
                                    </li>
                                    <li>Table elevatorControl, floorStats, and floorHistory all refer to nodeID in elevatorNetwork as foreign key.</li>
                                    <li>In order to add timestamp to a new row, use SQL default current_timestamp. Reference is <a href="https://www.mysqltutorial.org/mysql-timestamp.aspx">here</a></li>
                                    <li>floorStats and elevatorControl have a column updated_at, which will be updated automatically when the row is changed. Use SQL default timestamp on update current_timestamp </li>
                                    <li>To find the time stay in a floor, need a way to calculate the time different between 2 timestamps. Found a resource for DATEDIFF() in <a href="https://www.sqlteam.com/articles/working-with-time-spans-and-durations-in-sql-server">here</a></li>
                                    <li>It seems the MariaDB doesn't use the DATEDIFF() in a way as the resource above. It only requires 2 timestamps and always output difference in days, but I want output in second. Found the MariaDB official reference at <a href="https://mariadb.com/kb/en/timestampdiff/">here</a>. Can use TIMESTAMPDIFF() to output time difference in second.</li>
                                    <li>Next things I need are first and second record in the floorHistory. Have to use cascade SQL statements(select from select). Here are the SQL statements to update floorStats:</li>
                                    <ul>
                                        <li>UPDATE floorStats SET lastStaySec = (select timestampdiff(second, (select arrivalTime from (select arrivalTime from floorHistory order by arrivalTime desc limit 2) as tt order by arrivalTime  asc limit 1), (select arrivalTime from floorHistory order by arrivalTime desc limit 1)) as timeDiff from floorHistory limit 1), totalStaySec = (totalStaySec+ lastStaySec)
                                            WHERE nodeID = 2;</li>
                                        <li>UPDATE floorStats
                                            SET hits = (select count(*) from floorHistory where nodeID=1)
                                            WHERE nodeID = 1;</li>
                                    </ul>
                                </ul>
                                <li>Add C++ functions to update the database.</li>
                                <ul>
                                    <li>General design flow chart:</li>
                                    <img src="../images/weipeng_logbook/flow chart-94.jpg"/> 
                                    <li>Added CAN_getCrtFloor() to get the real elevator status from the CAN broadcasting message.</li>
                                    <li>Added db_setStatusBusy(), db_setStatusFree(), and db_logFloorChange() to update db tables whenever the elevator moves.</li>
                                    <li>Keep getting "Segmentation fault" error. Fixed by getting rid of deleting wrong pointers.</li>
                                    <li>The Segmentation error may still happened sometimes. Not sure why. If I commented out the deleting points lines, I don't get the segmentation fault error, but will get too many connections error from database.</li>
                                    <li>It's generally working fine now. The floorStats and floorHistory tables can be updated along with the floor changes.</li>
                                </ul>
                            </ul>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <br />
            <div id="week9">
                <div class="week_log" style="background-color: orange;">
                    <h1>Week 9</h1>
                    <ul style="line-height: 30px;">
                        <li>July 18, 2020
                            <ul>
                                <li>Working on the c++ to be able to report current floor to database and respond to the sudden change of request floor</li>
                                <li>During the elevator moving toward its next target, add constantly checking and set current floor to the database</li>
                                <li>Test: change request floor to 3, then change to floor 2 immdiately
                                    <ol>
                                        <li>Failed - elevator moved directly to floor 3</li>
                                        <li>Failed - same</li>
                                        <li>Failed - same</li>
                                        <li>Success - the elevator stopped at floor 2, but it's in a very rush way, feeling like stopped unexpectely</li>
                                        <li>Failed - same</li>
                                    </ol>     
                                </li>
                                <li>The result is not very good. It seems like the elevator is moving too fast to actually respond to the change of request.</li>
                                <li>Also the floor history log is not correct. Some logs show elevator moved from a floor to a same floor:</li>
                                <img src="../images/weipeng_logbook/history log error.png"/>
                                <li>It will be difficult to demo the ability of adapting to sudden change of request with the current elevator control loop. Considering re-make the elevator control loop.</li>
                                <li>New elevator control loop:</li>
                                <img src="../images/weipeng_logbook/new elevator control loop.jpeg" />
                                <li>After implement this new control loop, the elevator is able to respond to sudden changed request</li>
                            </ul>
                        </li>
                        <li>July 20, 2020
                            <ul>
                                <li>Fixed the elevator slow responding issue by adding back the CAN_close() to the end of CAN_getCrtFloor()</li>
                                <li>Fixed the fragmentation fault error by removing the unused res pointers in database functions.</li>
                                <li>Now the c++ program can run as long as user needs.</li>
                            </ul>
                        </li>
                        
                    </ul>
                </div>
            </div>
            <br />
            <div id="week10">
                <div class="week_log" style="background-color: rgb(0, 140, 255);">
                    <h1>Week 10</h1>
                    <ul style="line-height: 30px;">
                        <li>July 26, 2020
                            <ul>
                                <li>Work on making elevator annouce floor number in school rpi when reaches a floor
                                    <ul>
                                        <li>Prevously, has successfully used "omxplayer -o alsa filepath" to play audio. Since the school rpi video streaming is down again, assume this command works and will put it in the test c program.</li>
                                        <li>In audio.c, use fork() to off load the audio play command so that the main program can continue without waiting for audio finishes playing.</li>
                                        <li>The multi-process c program is working properly. Will integrate to the elevator control program</li>
                                        <li>Add a request floor and current target check in the main control loop. Once the current target is reached and it matches the request floor, the elevator floor number is announced.</li>
                                    </ul>
                                </li>
                                <li>Ceate Sabbath mode with the demo loop
                                    <ul>
                                        <li>The Sabbath mode will have the elevator repeatedly moved between floor 1 and floor 3. Whenever it reaches a floor, it annouces the floor number, wait for 10 seconds, then moves to the next floor.</li>
                                        <li>Simplify the move target control with an array = {1, 2, 3, 2}, then create a loop with index looping and incrementing</li>
                                        <li>Used existing functions from the gui control loop, the Sabbath mode now works properly. The history and stats will also be updated in this mode.</li>
                                        <img src="../images/weipeng_logbook/Sabbath mode.png"/>
                                    </ul>
                                </li>
                            </ul>
                        </li> 
                        <li>July 27, 2020
                            <ul>
                                <li>Remade diagnostic page with ajax functions. Now it can show all database tables dynamically and updates every second.</li>
                                <li>Help resources: 
                                    <ul>
                                        <li><a href="https://mdbootstrap.com/docs/jquery/tables/scroll/">responsive table</a></li>
                                        <li><a href="https://stackoverflow.com/questions/9001526/send-array-with-ajax-to-php-script/9001573">Send array with Ajax to PHP script</a></li>
                                        <li><a href="https://www.geeksforgeeks.org/what-is-stdclass-in-php/">Convert stdClass to array in PHP</a></li>
                                        <li><a href="https://www.if-not-true-then-false.com/2010/php-remove-last-character-from-string/">Remove characters from string in PHP</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                        <li>July 28, 2020
                            <ul>
                                <li>Improve table execution GUI so that only the valid column input will show up when table selection is changed.</li>
                                <li>If table selection is null, then execution dropdown will be hidden, and execution panel will be cleared out.</li>
                                <img src="../images/weipeng_logbook/table execution gui.png"/>
                                <li>Disable go button default behaviour to avoid page refreshing. The data will be updated through Ajax functions</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week11">
                <div class="week_log" style="background-color: rgb(0, 255, 85);">
                    <h1>Week 11</h1>
                    <ul style="line-height: 30px;">
                        <li>July 28, 2020
                            <ul>
                                <li>Add Exception handler in editSingleCellValue(). Now using transaction to deal with database communication. If execution result is failed or the affected row is not 1, will rollback the transaction and return the error message</li>
                                <li>Removed most echo lines from elevator_logic.php so that the only important messages will be showed in the frontend.</li>
                            </ul>
                        </li> 
                       <li>July 30, 2020
                            <ul>
                                <li>Fixed several bugs regarding updating values via the diagnostic page:
                                    <ul>
                                        <li>A function did not use the rowSelectKey() functions, which results in the wrong row key is used.</li>
                                        <li>When updating a cell value with letters, will need to append quotation marks around it.</li>
                                        <li>Passed back real error message from "$statement->errorInfo()".</li>
                                        <li>Add the authorized column to the request_access2.php.</li>
                                    </ul>
                                </li>
                            </ul>
                       </li>
                    </ul>
                </div>
            </div>
            <br />
            <div id="week12">
                <div class="week_log" style="background-color: rgb(0, 255, 255);">
                    <h1>Week 12</h1>
                    <ul style="line-height: 30px;">
                        <li>August 9, 2020
                            <ul>
                                <li>Make demo PowerPoint slides for final demo</li>
                                <li>Help Ramtin debug the stats page. The problem is that the bar chart sometimes cannot show all the values properly, but it will correct itselft after switching to other page and switch back. The chart creation uses chart.min.js, which is an external script and takes in an object Chart. I debugged the Chart object and the values that passed in are correct. My guess is that it is either a bug inside the external script, or the getValue from localStorage takes time, so the passed-in values are null.</li>
                            </ul>
                        </li> 
                       
                    </ul>
                </div>
            </div>
            <br />
        </div>
        <p style="text-align: center;">Copyright &copy 2020 Eduard Nishant Ramtin Weipeng</p>
</body>

</html>